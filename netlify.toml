[[plugins]]
  package = "@netlify/plugin-nextjs"

[build]
  command = "NODE_OPTIONS='--max-old-space-size=4096' tinacms build --skip-cloud-checks && next build"
  # Force cache clear - updated color palette

[build.environment]
  # Disable secrets scanning for specific environment variables that are safe to expose
  SECRETS_SCAN_OMIT_KEYS = "NEXT_PUBLIC_TINA_BRANCH,VERCEL_ENV,NEXT_PUBLIC_TINA_CLIENT_ID,TINA_TOKEN"

# Redirect /admin to the TinaCMS admin interface
[[redirects]]
  from = "/admin"
  to = "/admin/index.html"
  status = 200

# Note: Make sure these environment variables are configured in Netlify dashboard:
# - NEXT_PUBLIC_TINA_CLIENT_ID
# - TINA_TOKEN
# - TINA_SEARCH_TOKEN
# - NEXT_PUBLIC_TINA_BRANCH
# - PASSWORD
